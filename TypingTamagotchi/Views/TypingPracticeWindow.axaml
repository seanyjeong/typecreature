<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TypingTamagotchi.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="TypingTamagotchi.Views.TypingPracticeWindow"
        x:DataType="vm:TypingPracticeViewModel"
        Title="âŒ¨ï¸ íƒ€ì´í•‘ ì—°ìŠµ"
        Width="650" Height="480"
        WindowStartupLocation="CenterScreen"
        Background="#1A1A2E">

    <Window.Styles>
        <!-- íŒŒëž€ ë²„íŠ¼ (ì–¸ì–´ í† ê¸€, ë‹¤ìŒ ë¬¸ìž¥) -->
        <Style Selector="Button.blue">
            <Setter Property="Background" Value="#3D5A80"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        <Style Selector="Button.blue:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#5D8AC0"/>
        </Style>
        <Style Selector="Button.blue:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#1E3A5F"/>
        </Style>

        <!-- í•‘í¬ ë²„íŠ¼ (ê²©ì–¸/ì½”ë”© í† ê¸€) -->
        <Style Selector="Button.pink">
            <Setter Property="Background" Value="#E91E63"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        <Style Selector="Button.pink:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#FF6090"/>
        </Style>
        <Style Selector="Button.pink:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#AD1457"/>
        </Style>

        <!-- ë¹¨ê°„ ë²„íŠ¼ (ê·¸ë§Œí•˜ê¸°) -->
        <Style Selector="Button.red">
            <Setter Property="Background" Value="#E57373"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        <Style Selector="Button.red:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#FFAB91"/>
        </Style>
        <Style Selector="Button.red:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#B71C1C"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,Auto,*,Auto,Auto" Margin="20">

        <!-- ìƒë‹¨: ì–¸ì–´ í† ê¸€ + ì½”ë“œ í† ê¸€ -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
            <Button Classes="blue"
                    Content="{Binding LanguageButtonText}"
                    Command="{Binding ToggleLanguageCommand}"
                    Padding="12,6"/>
            <!-- ì˜ì–´ ëª¨ë“œì¼ ë•Œë§Œ ë³´ì´ëŠ” ì„œë¸Œ í† ê¸€ -->
            <Button Classes="pink"
                    IsVisible="{Binding ShowEnglishSubToggle}"
                    Command="{Binding ToggleCodeModeCommand}"
                    Padding="12,6">
                <Button.Content>
                    <StackPanel Orientation="Horizontal" Spacing="5">
                        <TextBlock Text="ðŸ“œ ê²©ì–¸" IsVisible="{Binding !IsCodeMode}"/>
                        <TextBlock Text="ðŸ’» ì½”ë”©" IsVisible="{Binding IsCodeMode}"/>
                        <TextBlock Text="â‡„"/>
                    </StackPanel>
                </Button.Content>
            </Button>
        </StackPanel>

        <!-- í†µê³„ ë°” -->
        <Border Grid.Row="1"
                Background="#2C3E50"
                CornerRadius="10"
                Padding="15"
                Margin="0,0,0,15">
            <Grid ColumnDefinitions="*,*,*,*,*,*">
                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="í˜„ìž¬ íƒ€ìˆ˜"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentCPM}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#4CAF50"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="ìµœê³  íƒ€ìˆ˜"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding MaxCPM}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#FF6B6B"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="í‰ê·  íƒ€ìˆ˜"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding AverageCPM}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#81C784"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                    <TextBlock Text="ì •í™•ë„"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding AccuracyText}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#FFD700"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                    <TextBlock Text="ì™„ë£Œ"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding CompletedCount}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#2196F3"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="5" HorizontalAlignment="Center">
                    <TextBlock Text="ë¶€í™” ê¸°ì—¬"
                               FontSize="11"
                               Foreground="#888"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding HatchContribution}"
                               FontSize="16"
                               FontWeight="Bold"
                               Foreground="#E040FB"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ì¤‘ì•™: ë¬¸ìž¥ í‘œì‹œ ì˜ì—­ -->
        <Border Grid.Row="2"
                Background="#16213E"
                CornerRadius="10"
                Padding="20"
                Margin="0,0,0,15">
            <Grid RowDefinitions="*,Auto">
                <!-- ëª©í‘œ ë¬¸ìž¥ -->
                <StackPanel Grid.Row="0" VerticalAlignment="Center">
                    <TextBlock Text="ë‹¤ìŒ ë¬¸ìž¥ì„ ìž…ë ¥í•˜ì„¸ìš”:"
                               FontSize="12"
                               Foreground="#666"
                               Margin="0,0,0,10"/>

                    <!-- ë¬¸ìž¥ í‘œì‹œ (ê¸€ìžë³„ ìƒ‰ìƒ) -->
                    <ItemsControl ItemsSource="{Binding DisplayChars}" HorizontalAlignment="Center">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Char}"
                                           FontSize="28"
                                           FontWeight="Bold"
                                           FontFamily="Malgun Gothic, Segoe UI"
                                           Foreground="{Binding Color}"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- ì˜ì–´ ë¬¸ìž¥ ë²ˆì—­ -->
                    <TextBlock Text="{Binding CurrentTranslation}"
                               FontSize="14"
                               Foreground="#9E9E9E"
                               FontStyle="Italic"
                               HorizontalAlignment="Center"
                               Margin="0,12,0,0"
                               IsVisible="{Binding ShowTranslation}"/>

                    <!-- Enter ì•ˆë‚´ (ë¬¸ìž¥ ì™„ë£Œ ì‹œ) -->
                    <TextBlock Text="âœ“ Enterë¥¼ ëˆŒëŸ¬ ë‹¤ìŒ ë¬¸ìž¥ìœ¼ë¡œ!"
                               FontSize="14"
                               Foreground="#4CAF50"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               Margin="0,15,0,0"
                               IsVisible="{Binding IsReadyForNext}"/>
                </StackPanel>

                <!-- ì§„í–‰ ë°” -->
                <Border Grid.Row="1"
                        Background="#1A1A2E"
                        CornerRadius="4"
                        Height="8"
                        Margin="0,15,0,0">
                    <Border CornerRadius="4"
                            HorizontalAlignment="Left"
                            Width="{Binding ProgressWidth}">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                                <GradientStop Color="#4CAF50" Offset="0"/>
                                <GradientStop Color="#81C784" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                </Border>
            </Grid>
        </Border>

        <!-- ìž…ë ¥ ì˜ì—­ -->
        <Border Grid.Row="3"
                Background="#2C3E50"
                CornerRadius="10"
                Padding="15"
                Margin="0,0,0,15">
            <TextBox Name="InputTextBox"
                     Watermark="ì—¬ê¸°ì— ìž…ë ¥í•˜ì„¸ìš”..."
                     FontSize="20"
                     FontFamily="Malgun Gothic, Segoe UI"
                     BorderThickness="2"
                     BorderBrush="#3D5A80"
                     Padding="10"
                     CornerRadius="6"
                     AcceptsReturn="False"
                     Background="#1A1A2E"
                     Foreground="White"
                     CaretBrush="#4CAF50">
                <TextBox.Styles>
                    <!-- TextPresenter ì§ì ‘ ìŠ¤íƒ€ì¼ë§ -->
                    <Style Selector="TextBox /template/ TextPresenter">
                        <Setter Property="TextBlock.Foreground" Value="White"/>
                    </Style>
                    <Style Selector="TextBox:focus /template/ TextPresenter">
                        <Setter Property="TextBlock.Foreground" Value="White"/>
                    </Style>
                    <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
                        <Setter Property="Background" Value="#1A1A2E"/>
                    </Style>
                    <Style Selector="TextBox /template/ Border#PART_BorderElement">
                        <Setter Property="Background" Value="#1A1A2E"/>
                    </Style>
                </TextBox.Styles>
            </TextBox>
        </Border>

        <!-- í•˜ë‹¨ ë²„íŠ¼ -->
        <Grid Grid.Row="4" ColumnDefinitions="*,Auto,Auto">
            <TextBlock Grid.Column="0"
                       Text="{Binding InstructionText}"
                       FontSize="11"
                       Foreground="#666"
                       VerticalAlignment="Center"
                       TextWrapping="Wrap"/>
            <Button Grid.Column="1"
                    Classes="blue"
                    Content="ðŸ”„ ë‹¤ìŒ ë¬¸ìž¥"
                    Padding="15,8"
                    Margin="0,0,10,0"
                    Command="{Binding SkipCommand}"/>
            <Button Grid.Column="2"
                    Classes="red"
                    Content="ê·¸ë§Œí•˜ê¸°"
                    Padding="15,8"
                    Click="OnCloseClick"/>
        </Grid>
    </Grid>
</Window>
