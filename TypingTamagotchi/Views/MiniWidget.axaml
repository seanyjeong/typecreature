<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TypingTamagotchi.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="TypingTamagotchi.Views.MiniWidget"
        x:DataType="vm:MiniWidgetViewModel"
        Title="TypeCreature"
        Width="340" Height="500"
        CanResize="False"
        SystemDecorations="None"
        Topmost="True"
        Background="Transparent">

    <Border CornerRadius="16"
            BorderBrush="#4A5568"
            BorderThickness="2"
            Padding="14">
        <Border.Background>
            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                <GradientStop Color="#2C3E50" Offset="0"/>
                <GradientStop Color="#1A252F" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Opacity="0.4" OffsetX="0" OffsetY="6"/>
        </Border.Effect>

        <Grid RowDefinitions="Auto,Auto,*,Auto,Auto">

            <!-- ìƒë‹¨: ë¡œì–„ ì‹œê³„ ìœ„ì ¯ -->
            <Border Grid.Row="0"
                    CornerRadius="10"
                    Padding="12,6"
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center"
                    BorderBrush="#D4AF37"
                    BorderThickness="2">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#8B6914" Offset="0"/>
                        <GradientStop Color="#D4AF37" Offset="0.3"/>
                        <GradientStop Color="#FFD700" Offset="0.5"/>
                        <GradientStop Color="#D4AF37" Offset="0.7"/>
                        <GradientStop Color="#8B6914" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="8" Opacity="0.4" OffsetY="2"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ‘‘"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentTime}"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="#1A1A1A"
                               FontFamily="Consolas, Courier New"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentDate}"
                               FontSize="10"
                               Foreground="#3D3D3D"
                               VerticalAlignment="Center"
                               Margin="4,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- ê³¨ë“œ íƒ€ì´í‹€ (í´ë¦­ì‹œ ë„ê° ì—´ê¸°) -->
            <Border Grid.Row="1"
                    CornerRadius="8"
                    Padding="10,6"
                    Margin="0,0,0,8"
                    Cursor="Hand"
                    PointerPressed="OnCollectionTitleClick">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#B8860B" Offset="0"/>
                        <GradientStop Color="#DAA520" Offset="0.25"/>
                        <GradientStop Color="#FFD700" Offset="0.5"/>
                        <GradientStop Color="#DAA520" Offset="0.75"/>
                        <GradientStop Color="#B8860B" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="8" Opacity="0.3" OffsetX="0" OffsetY="2"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ‘‘"
                               FontSize="14"
                               VerticalAlignment="Center"
                               Margin="0,0,6,0"/>
                    <TextBlock Text="COLLECTION"
                               FontSize="13"
                               FontWeight="Bold"
                               Foreground="#1A1A1A"
                               LetterSpacing="2"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- ì¤‘ì•™: ë¡œì–„ ì‡¼ì¼€ì´ìŠ¤ -->
            <Grid Grid.Row="2" Margin="0,0,0,8" MinHeight="320">
                <!-- ì‡¼ì¼€ì´ìŠ¤ ë°°ê²½ ì´ë¯¸ì§€ -->
                <Image Source="/Assets/UI/showcase_royal.png"
                       Stretch="Fill"
                       Margin="-10"/>

                <!-- í¬ë¦¬ì²˜ ìŠ¬ë¡¯ ê·¸ë¦¬ë“œ -->
                <Border Padding="24,32,24,20">
                    <ItemsControl ItemsSource="{Binding DisplaySlots}" Name="SlotsContainer">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="3" Rows="4"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <!-- ì‹¬í”Œ ìŠ¬ë¡¯ - ì‡¼ì¼€ì´ìŠ¤ ì¹¸ì— ë§žê²Œ -->
                                <Border Margin="2" Cursor="Hand">
                                    <Grid>
                                        <!-- í¬ë¦¬ì²˜ ì´ë¯¸ì§€ -->
                                        <Image Source="{Binding CreatureImage}"
                                               IsVisible="{Binding HasCreature}"
                                               Width="58" Height="58"
                                               Stretch="Uniform"
                                               RenderOptions.BitmapInterpolationMode="HighQuality"/>

                                        <!-- ë¹ˆ ìŠ¬ë¡¯ (íˆ¬ëª…) -->
                                        <Border IsVisible="{Binding IsEmpty}"
                                                Opacity="0"/>

                                        <!-- ë“±ê¸‰ ë³´ì„ (ìš°í•˜ë‹¨) -->
                                        <Border IsVisible="{Binding HasCreature}"
                                                Width="10" Height="10"
                                                CornerRadius="5"
                                                Background="{Binding RarityColor}"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Bottom"
                                                Margin="0,0,2,2">
                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="3" Opacity="0.6"/>
                                            </Border.Effect>
                                        </Border>
                                    </Grid>

                                    <!-- íˆ´íŒ -->
                                    <ToolTip.Tip>
                                        <StackPanel>
                                            <TextBlock Text="{Binding CreatureName}"
                                                       FontWeight="Bold"
                                                       Foreground="{Binding RarityColor}"/>
                                            <TextBlock Text="{Binding RarityText}"
                                                       FontSize="10"
                                                       Foreground="#888"
                                                       IsVisible="{Binding HasCreature}"/>
                                        </StackPanel>
                                    </ToolTip.Tip>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>
            </Grid>

            <!-- í¬ë¦¬ì³ ìˆ˜ì§‘ í˜„í™© -->
            <Border Grid.Row="3"
                    Background="#15FFFFFF"
                    CornerRadius="6"
                    Padding="8,4"
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ“¦"
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="ìˆ˜ì§‘ í˜„í™©:"
                               FontSize="11"
                               Foreground="#888"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CollectionText}"
                               FontSize="13"
                               FontWeight="Bold"
                               Foreground="#FFD700"
                               VerticalAlignment="Center"/>
                    <Border Background="#2A2A3A"
                            CornerRadius="2"
                            Height="6"
                            Width="60"
                            VerticalAlignment="Center">
                        <Border CornerRadius="2"
                                HorizontalAlignment="Left"
                                Width="{Binding CollectionProgressWidth}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                                    <GradientStop Color="#B8860B" Offset="0"/>
                                    <GradientStop Color="#FFD700" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>
                </StackPanel>
            </Border>

            <!-- í•˜ë‹¨: ì•Œ ì§„í–‰ ìƒí™© -->
            <Border Grid.Row="4"
                    CornerRadius="8"
                    Padding="10,6">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#2D2D4C" Offset="0"/>
                        <GradientStop Color="#3D3D5C" Offset="0.5"/>
                        <GradientStop Color="#2D2D4C" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="6">
                        <TextBlock Text="ðŸ¥š" FontSize="16" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding EggName}"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Foreground="#E0E0E0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- í”„ë¡œê·¸ë ˆìŠ¤ ë°” (ê¸ˆìƒ‰ ê·¸ë¼ë°ì´ì…˜) -->
                    <Border Grid.Column="1"
                            Background="#1A1A2E"
                            CornerRadius="4"
                            Height="8"
                            Margin="12,0"
                            VerticalAlignment="Center">
                        <Border CornerRadius="4"
                                HorizontalAlignment="Left"
                                Width="{Binding ProgressWidth}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                                    <GradientStop Color="#B8860B" Offset="0"/>
                                    <GradientStop Color="#FFD700" Offset="0.5"/>
                                    <GradientStop Color="#FFF8DC" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>

                    <TextBlock Grid.Column="2"
                               Text="{Binding ProgressText}"
                               FontSize="12"
                               FontWeight="Bold"
                               Foreground="#FFD700"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
