<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TypingTamagotchi.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="TypingTamagotchi.Views.MiniWidget"
        x:DataType="vm:MiniWidgetViewModel"
        Title="TypeCreature"
        Width="400" Height="280"
        CanResize="False"
        SystemDecorations="None"
        Topmost="True"
        Background="Transparent">

    <Border CornerRadius="16"
            BorderBrush="#4A5568"
            BorderThickness="2"
            Padding="14">
        <Border.Background>
            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                <GradientStop Color="#2C3E50" Offset="0"/>
                <GradientStop Color="#1A252F" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Opacity="0.4" OffsetX="0" OffsetY="6"/>
        </Border.Effect>

        <Grid RowDefinitions="Auto,Auto,*,Auto,Auto">

            <!-- ìƒë‹¨: ì‹œê³„ ìœ„ì ¯ -->
            <Border Grid.Row="0"
                    CornerRadius="8"
                    Padding="8,4"
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#1A1A2E" Offset="0"/>
                        <GradientStop Color="#2D2D4C" Offset="0.5"/>
                        <GradientStop Color="#1A1A2E" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="ðŸ•"
                               FontSize="16"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentTime}"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="#E0E0E0"
                               FontFamily="Consolas, Courier New"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentDate}"
                               FontSize="10"
                               Foreground="#888"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- ê³¨ë“œ íƒ€ì´í‹€ -->
            <Border Grid.Row="1"
                    CornerRadius="8"
                    Padding="10,6"
                    Margin="0,0,0,8">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#B8860B" Offset="0"/>
                        <GradientStop Color="#DAA520" Offset="0.25"/>
                        <GradientStop Color="#FFD700" Offset="0.5"/>
                        <GradientStop Color="#DAA520" Offset="0.75"/>
                        <GradientStop Color="#B8860B" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="8" Opacity="0.3" OffsetX="0" OffsetY="2"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ‘‘"
                               FontSize="14"
                               VerticalAlignment="Center"
                               Margin="0,0,6,0"/>
                    <TextBlock Text="COLLECTION"
                               FontSize="13"
                               FontWeight="Bold"
                               Foreground="#1A1A1A"
                               LetterSpacing="2"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- ì¤‘ì•™: ëŸ­ì…”ë¦¬ ì§„ì—´ìž¥ -->
            <Border Grid.Row="2"
                    CornerRadius="10"
                    BorderBrush="#3D3D5C"
                    BorderThickness="2"
                    Padding="8"
                    Margin="0,0,0,8"
                    MinHeight="80">
                <Border.Background>
                    <LinearGradientBrush StartPoint="50%,0%" EndPoint="50%,100%">
                        <GradientStop Color="#1E1E2E" Offset="0"/>
                        <GradientStop Color="#12121A" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>

                <!-- ìœ ë¦¬ í”„ë ˆìž„ -->
                <Border CornerRadius="8"
                        Padding="6">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="50%,0%" EndPoint="50%,100%">
                            <GradientStop Color="#15151F" Offset="0"/>
                            <GradientStop Color="#0D0D12" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>

                    <Grid>
                        <!-- ì§„ì—´ëŒ€ ì„ ë°˜ (ë²¨ë²³ ëŠë‚Œ) -->
                        <Border CornerRadius="6"
                                Padding="4">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="50%,0%" EndPoint="50%,100%">
                                    <GradientStop Color="#2D1F3D" Offset="0"/>
                                    <GradientStop Color="#1A1225" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>

                            <ItemsControl ItemsSource="{Binding DisplaySlots}" Name="SlotsContainer">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Columns="10" Rows="1"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <!-- ê°œë³„ ë°›ì¹¨ëŒ€ -->
                                        <Border Width="32" Height="58"
                                                Margin="1"
                                                CornerRadius="4"
                                                Name="SlotBorder"
                                                Tag="{Binding SlotIndex}"
                                                Classes="slot">

                                            <Grid RowDefinitions="*,Auto">
                                                <!-- í¬ë¦¬ì²˜ í‘œì‹œ ì˜ì—­ -->
                                                <Border Grid.Row="0"
                                                        Background="{Binding SlotBackground}"
                                                        CornerRadius="4,4,0,0"
                                                        Margin="2,2,2,0">
                                                    <Grid>
                                                        <!-- ë¹ˆ ìŠ¬ë¡¯ í‘œì‹œ -->
                                                        <Border IsVisible="{Binding IsEmpty}"
                                                                Background="#20FFFFFF"
                                                                CornerRadius="4"
                                                                Opacity="0.3">
                                                            <TextBlock Text="+"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center"
                                                                       FontSize="18"
                                                                       Foreground="#4A4A5A"/>
                                                        </Border>

                                                        <!-- í¬ë¦¬ì²˜ ì´ë¯¸ì§€ -->
                                                        <Image Source="{Binding CreatureImage}"
                                                               IsVisible="{Binding HasCreature}"
                                                               Width="26" Height="26"
                                                               Margin="0,2,0,0"
                                                               VerticalAlignment="Top"
                                                               Stretch="Uniform"
                                                               RenderOptions.BitmapInterpolationMode="HighQuality"/>

                                                        <!-- ë¹› ë°˜ì‚¬ íš¨ê³¼ -->
                                                        <Border IsVisible="{Binding HasCreature}"
                                                                CornerRadius="4"
                                                                IsHitTestVisible="False">
                                                            <Border.Background>
                                                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                                                    <GradientStop Color="#30FFFFFF" Offset="0"/>
                                                                    <GradientStop Color="#00FFFFFF" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>
                                                    </Grid>
                                                </Border>

                                                <!-- ê³ ê¸‰ ë°›ì¹¨ëŒ€ (ê¸ˆìƒ‰ í…Œë‘ë¦¬ + ë“±ê¸‰ ë³´ì„) -->
                                                <Border Grid.Row="1"
                                                        Height="14"
                                                        CornerRadius="0,0,4,4"
                                                        BorderBrush="#D4AF37"
                                                        BorderThickness="1,0,1,1"
                                                        Margin="2,0,2,2">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="50%,0%" EndPoint="50%,100%">
                                                            <GradientStop Color="#3D3D5C" Offset="0"/>
                                                            <GradientStop Color="#2D2D4C" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                    <Grid>
                                                        <!-- ë°›ì¹¨ëŒ€ ê¸ˆìƒ‰ ë¼ì¸ -->
                                                        <Border Height="1"
                                                                VerticalAlignment="Top">
                                                            <Border.Background>
                                                                <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                                                                    <GradientStop Color="#00000000" Offset="0"/>
                                                                    <GradientStop Color="#40D4AF37" Offset="0.5"/>
                                                                    <GradientStop Color="#00000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>

                                                        <!-- ë“±ê¸‰ ë³´ì„ -->
                                                        <Border IsVisible="{Binding HasCreature}"
                                                                Width="8" Height="8"
                                                                CornerRadius="4"
                                                                Background="{Binding RarityColor}"
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center">
                                                            <Border.Effect>
                                                                <DropShadowEffect BlurRadius="4"
                                                                                  Opacity="0.8"
                                                                                  OffsetX="0"
                                                                                  OffsetY="0"
                                                                                  Color="White"/>
                                                            </Border.Effect>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                            </Grid>

                                            <!-- íˆ´íŒ -->
                                            <ToolTip.Tip>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding CreatureName}"
                                                               FontWeight="Bold"
                                                               Foreground="{Binding RarityColor}"/>
                                                    <TextBlock Text="{Binding RarityText}"
                                                               FontSize="10"
                                                               Foreground="#888"
                                                               IsVisible="{Binding HasCreature}"/>
                                                </StackPanel>
                                            </ToolTip.Tip>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>

                        <!-- ìœ ë¦¬ ë°˜ì‚¬ ì˜¤ë²„ë ˆì´ -->
                        <Border CornerRadius="6"
                                IsHitTestVisible="False">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Color="#15FFFFFF" Offset="0"/>
                                    <GradientStop Color="#05FFFFFF" Offset="0.5"/>
                                    <GradientStop Color="#00FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Grid>
                </Border>
            </Border>

            <!-- í¬ë¦¬ì³ ìˆ˜ì§‘ í˜„í™© -->
            <Border Grid.Row="3"
                    Background="#15FFFFFF"
                    CornerRadius="6"
                    Padding="8,4"
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ“¦"
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="ìˆ˜ì§‘ í˜„í™©:"
                               FontSize="11"
                               Foreground="#888"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CollectionText}"
                               FontSize="13"
                               FontWeight="Bold"
                               Foreground="#FFD700"
                               VerticalAlignment="Center"/>
                    <ProgressBar Value="{Binding CollectionProgress}"
                                 Minimum="0" Maximum="1"
                                 Height="4"
                                 Width="60"
                                 VerticalAlignment="Center"
                                 Foreground="#FFD700"
                                 Background="#2A2A3A"/>
                </StackPanel>
            </Border>

            <!-- í•˜ë‹¨: ì•Œ ì§„í–‰ ìƒí™© -->
            <Border Grid.Row="4"
                    CornerRadius="8"
                    Padding="10,6">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                        <GradientStop Color="#2D2D4C" Offset="0"/>
                        <GradientStop Color="#3D3D5C" Offset="0.5"/>
                        <GradientStop Color="#2D2D4C" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="6">
                        <TextBlock Text="ðŸ¥š" FontSize="16" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding EggName}"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Foreground="#E0E0E0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- í”„ë¡œê·¸ë ˆìŠ¤ ë°” (ê¸ˆìƒ‰ ê·¸ë¼ë°ì´ì…˜) -->
                    <Border Grid.Column="1"
                            Background="#1A1A2E"
                            CornerRadius="4"
                            Height="8"
                            Margin="12,0"
                            VerticalAlignment="Center">
                        <Border CornerRadius="4"
                                HorizontalAlignment="Left"
                                Width="{Binding ProgressWidth}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
                                    <GradientStop Color="#B8860B" Offset="0"/>
                                    <GradientStop Color="#FFD700" Offset="0.5"/>
                                    <GradientStop Color="#FFF8DC" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                    </Border>

                    <TextBlock Grid.Column="2"
                               Text="{Binding ProgressText}"
                               FontSize="12"
                               FontWeight="Bold"
                               Foreground="#FFD700"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
